<%= link_to "Create a new Game", new_game_path, class: "btn btn-ghost" %>


<table class="table table-hover">
  <tr>
    <th>Start Date</th>
    <th>Name</th>
    <th>Blinds</th>
    <th>Max. Bet</th>
    <th>Amount Played</th>
    <th>Average Pot</th>
    <th>Active Players</th>
    <th>State</th>
    <th></th>
  </tr>

  <% @games.each do |game| %>
    <tr>
      <td><%= game.created_at.strftime("%e %^b %Y")  %></td>
      <td><%= game.name %></td>
      <td>1€/1€</td>
      <td>30€</td>
      <% total_amount_played = 0 %>
      <% pot_count = 0 %>
      <% game.hands.each do |hand| %>
        <% if hand.pot != nil %>
          <% total_amount_played += hand.pot %>
          <% pot_count += 1 %>
        <% end %>
      <% end %>
      <% if pot_count != 0 %>
        <% average_pot = ((total_amount_played / pot_count.to_f).round(1) % 1 == 0 ? ((total_amount_played / pot_count.to_f).round(1).to_i) : ((total_amount_played / pot_count.to_f).round(1)))  %>
      <% else %>
        <% average_pot = 0 %>
      <% end %>
      <td><%= total_amount_played %>€</td>
      <td><%= average_pot %>€</td>

      <td><%= Reservation.where(game: game, active: true).count %></td>
      <td>Active</td>
      <td>
        <%= link_to game_path(game), target: :_blank do %>
          <p>➡|</p>
        <% end %>
      </td>
    </tr>
  <% end %>

</table>


<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>


<div class="cards">
  <% @games.each do |game| %>
    <%= link_to game_path(game), target: :_blank do %>
      <div class="card-category" style="background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), url(<%= @poker_url.sample %>)">
        <%= game.name %>
      </div>
    <% end  %>
  <% end %>
</div>
